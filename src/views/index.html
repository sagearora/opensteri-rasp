<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenSteri Printer Portal</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>OpenSteri Printer Portal</h1>
            <p>Complete your printer setup and configuration</p>
        </div>
        
        <!-- Section 1: WiFi Setup -->
        <div class="section">
            <div class="section-header">
                <div class="section-icon wifi-icon-bg">
                    üì∂
                </div>
                <div>
                    <h2 class="section-title">WiFi Setup</h2>
                    <p class="section-subtitle">Connect your printer to your local network</p>
                </div>
            </div>
            
            <!-- Compact WiFi Status (shown when connected) -->
            <div id="wifiCompactStatus" class="compact-status" style="display: none;">
                <div class="compact-status-card">
                    <div class="compact-status-content">
                        <div class="compact-status-icon connected">
                            ‚úÖ
                        </div>
                        <div class="compact-status-info">
                            <span class="compact-status-value" id="compactNetworkName">Network Name</span>
                            <span class="compact-status-details" id="compactNetworkDetails">Signal: 85% (Connected)</span>
                        </div>
                    </div>
                    <div class="compact-status-actions">
                        <button type="button" id="compactEditWifiBtn" class="btn-compact">
                            ‚úèÔ∏è Edit
                        </button>
                        <button type="button" id="compactDisconnectWifiBtn" class="btn-compact btn-compact-danger">
                            üîå Disconnect
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- WiFi Connection Status (shown when connected) -->
            <div id="wifiStatus" class="wifi-status" style="display: none;">
                <div class="status-card">
                    <div class="status-header">
                        <div class="status-icon connected">
                            üì∂
                        </div>
                        <div class="status-info">
                            <h3 id="connectedNetwork">Network Name</h3>
                            <p id="connectionDetails">Connected ‚Ä¢ Signal: 85% ‚Ä¢ IP: 192.168.1.100</p>
                        </div>
                    </div>
                    <div class="status-actions">
                        <button type="button" id="editWifiBtn" class="btn btn-ghost">
                            ‚úèÔ∏è Edit Connection
                        </button>
                        <button type="button" id="disconnectWifiBtn" class="btn btn-danger">
                            üîå Disconnect
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- WiFi Connect Form (shown when not connected) -->
            <div id="wifiConnectForm">
                <form id="wifiForm">
                    <div class="form-group">
                        <label for="networkSelect">Select WiFi Network:</label>
                        <select id="networkSelect" name="network" required>
                            <option value="">Select a network...</option>
                        </select>
                        <div class="rescan-container">
                            <button type="button" id="rescanBtn" class="btn btn-ghost">
                                Can't find your WiFi? Rescan.
                            </button>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="password">WiFi Password:</label>
                        <input type="password" id="password" name="password" placeholder="Enter WiFi password" required>
                    </div>
                    
                    <button type="submit" class="btn btn-primary">
                        <span>üîó</span>
                        Connect to WiFi
                    </button>
                </form>
            </div>
            
            <!-- WiFi Edit Form (shown when editing connection) -->
            <div id="wifiEditForm" style="display: none;">
                <form id="editWifiForm">
                    <div class="form-group">
                        <label for="editNetworkSelect">Select WiFi Network:</label>
                        <select id="editNetworkSelect" name="network" required>
                            <option value="">Select a network...</option>
                        </select>
                        <div class="rescan-container">
                            <button type="button" id="editRescanBtn" class="btn btn-ghost">
                                Can't find your WiFi? Rescan.
                            </button>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="editPassword">WiFi Password:</label>
                        <input type="password" id="editPassword" name="password" placeholder="Enter WiFi password" required>
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">
                            <span>üíæ</span>
                            Update Connection
                        </button>
                        <button type="button" id="cancelEditBtn" class="btn btn-ghost">
                            Cancel
                        </button>
                    </div>
                </form>
            </div>
            
            <div id="wifiLoading" class="loading">
                <p>Checking WiFi status...</p>
            </div>
            
            <div id="wifiError" class="error"></div>
            <div id="wifiSuccess" class="success"></div>
        </div>
        
        <!-- Section 2: OpenSteri Connection -->
        <div class="section">
            <div class="section-header">
                <div class="section-icon credentials-icon-bg">
                    üîê
                </div>
                <div>
                    <h2 class="section-title">OpenSteri Connection</h2>
                    <p class="section-subtitle">Connect to your OpenSteri account and manage printer</p>
                </div>
            </div>
            
            <!-- Compact OpenSteri Status (shown when connected) -->
            <div id="opensteriCompactStatus" class="compact-status" style="display: none;">
                <div class="compact-status-card">
                    <div class="compact-status-content">
                        <div class="compact-status-icon connected">
                            ‚úÖ
                        </div>
                        <div class="compact-status-info">
                            <span class="compact-status-value">Connected</span>
                            <span class="compact-status-details" id="compactOpensteriDetails">Printer ID: ... ‚Ä¢ Token: Active</span>
                        </div>
                    </div>
                    <div class="compact-status-actions">
                        <button type="button" id="compactDisconnectOpensteriBtn" class="btn-compact btn-compact-danger">
                            üîå Disconnect
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- OpenSteri Connection Status (shown when connected) -->
            <div id="opensteriStatus" class="opensteri-status" style="display: none;">
                <div class="status-card">
                    <div class="status-header">
                        <div class="status-icon connected">
                            üîê
                        </div>
                        <div class="status-info">
                            <h3 id="connectedAccount">OpenSteri Account</h3>
                            <p id="connectionDetails">Connected ‚Ä¢ Printer ID: ... ‚Ä¢ Token: Active</p>
                        </div>
                    </div>
                    <div class="status-actions">
                        <button type="button" id="disconnectOpensteriBtn" class="btn btn-danger">
                            üîå Disconnect Printer
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- OpenSteri Connect Form (shown when not connected) -->
            <div id="opensteriConnectForm">
                <!-- Empty - join code input is handled separately -->
            </div>
            
            <!-- Join Code Input (shown when not connected) -->
            <div id="joinCodeSection" style="display: none;">
                <form id="joinCodeForm">
                    <div class="form-group">
                        <label for="newJoinToken">Join Code:</label>
                        <input type="text" id="newJoinToken" name="joinToken" placeholder="Enter your join code" required>
                    </div>
                    
                    <button type="submit" class="btn btn-warning">
                        <span>üîó</span>
                        Join OpenSteri
                    </button>
                </form>
            </div>
            
            <div id="credentialsLoading" class="loading">
                <p>Joining OpenSteri...</p>
            </div>
            
            <div id="credentialsError" class="error"></div>
            <div id="credentialsSuccess" class="success"></div>
        </div>
        
        <!-- Section 3: Godex Printer Detection -->
        <div class="section">
            <div class="section-header">
                <div class="section-icon printer-icon-bg">
                    üñ®Ô∏è
                </div>
                <div>
                    <h2 class="section-title">Godex Printer Detection</h2>
                    <p class="section-subtitle">Check for connected Godex printer and verify functionality</p>
                </div>
            </div>
            
            <!-- Compact Printer Status (shown when connected) -->
            <div id="printerCompactStatus" class="compact-status" style="display: none;">
                <div class="compact-status-card">
                    <div class="compact-status-content">
                        <div class="compact-status-icon connected">
                            ‚úÖ
                        </div>
                        <div class="compact-status-info">
                            <span class="compact-status-value" id="compactPrinterName">Godex EZ-1105</span>
                            <span class="compact-status-details" id="compactPrinterDetails">Connected ‚Ä¢ Ready to print</span>
                        </div>
                    </div>
                    <div class="compact-status-actions">
                        <button type="button" id="compactTestPrintBtn" class="btn-compact">
                            üñ®Ô∏è Test Print
                        </button>
                        <button type="button" id="compactRefreshPrinterBtn" class="btn-compact">
                            üîÑ Refresh
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Printer Connection Status (shown when connected) -->
            <div id="printerStatus" class="printer-status" style="display: none;">
                <div class="status-card">
                    <div class="status-header">
                        <div class="status-icon connected">
                            üñ®Ô∏è
                        </div>
                        <div class="status-info">
                            <h3 id="connectedPrinter">Godex EZ-1105</h3>
                            <p id="printerDetails">Connected ‚Ä¢ Ready to print ‚Ä¢ USB Port: /dev/usb/lp0</p>
                        </div>
                    </div>
                    <div class="status-actions">
                        <button type="button" id="testPrintBtn" class="btn btn-success">
                            üñ®Ô∏è Test Print
                        </button>
                        <button type="button" id="refreshPrinterBtn" class="btn btn-outline">
                            üîÑ Refresh Status
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Printer Detection Form (shown when not connected) -->
            <div id="printerConnectForm">
                <div class="printer-detection-info">
                    <p>No Godex printer detected. Please ensure your printer is:</p>
                    <ul>
                        <li>Connected via USB cable</li>
                        <li>Powered on and ready</li>
                        <li>Properly installed with drivers</li>
                    </ul>
                </div>
                
                <!-- Printer Setup Video -->
                <div class="printer-setup-video">
                    <h3>Printer Setup Guide</h3>
                    <div class="video-placeholder">
                        <div class="video-icon">üìπ</div>
                        <p>Video: How to connect and set up your Godex printer</p>
                        <button type="button" id="playSetupVideoBtn" class="btn btn-outline">
                            <span>‚ñ∂Ô∏è</span>
                            Play Setup Video
                        </button>
                    </div>
                </div>
                
                <div class="printer-actions">
                    <button type="button" id="detectPrinterBtn" class="btn btn-primary">
                        <span>üîç</span>
                        Detect Printer
                    </button>
                </div>
            </div>
            
            <div id="printerLoading" class="loading">
                <p>Checking printer status...</p>
            </div>
            
            <div id="printerError" class="error"></div>
            <div id="printerSuccess" class="success"></div>
        </div>
    </div>

    <!-- Video Player Modal -->
    <div id="videoModal" class="video-modal" style="display: none;">
        <div class="video-modal-content">
            <div class="video-modal-header">
                <h3>Printer Setup Guide</h3>
                <button type="button" id="closeVideoBtn" class="close-video-btn">√ó</button>
            </div>
            <div class="video-player-container">
                <video id="setupVideo" controls>
                    <source src="/static/videos/printer-setup.mp4" type="video/mp4">
                    <source src="/static/videos/printer-setup.webm" type="video/webm">
                    Your browser does not support the video tag.
                </video>
            </div>
        </div>
    </div>

    <script src="/static/script.js"></script>
</body>
</html> 