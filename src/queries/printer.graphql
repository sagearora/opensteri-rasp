
fragment PrinterCommand on printer_command {
    id
    created_at
    printer_id
    command
    data
    executed_at
}

fragment Printer on printer {
  id
  clinic_id
  paired_at
  last_seen_at
  version_number
  update_started_at
  archived_at
  commands(where: {executed_at: {_is_null: true}}, order_by: {id: asc}, limit: 1) {
    ...PrinterCommand
  }
}

query getPrinter($printerId: uuid!) {
  printer_by_pk(id: $printerId) {
    ...Printer  
  }
}

mutation updatePrinter($printerId: uuid!, $set: printer_set_input!) {
  update_printer_by_pk(pk_columns: {id: $printerId}, _set: $set) {
    id
    last_seen_at
  }
}


subscription watchPrinter($printerId: uuid!) {
  printer_by_pk(id: $printerId) {
    ...Printer
  }
}

mutation updatePrinterCommand($id: bigint!, $set: printer_command_set_input!) {
  update_printer_command_by_pk(pk_columns: {id: $id}, _set: $set) {
    id
  }
}