<!DOCTYPE html>
<html lang="en">
<head>
  <title>OpenSteri Wi-Fi Status</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css?family=Inter:400,500,800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="shared.css">
</head>
<body>
  <nav class="navbar">
    <a href="/" class="logo">OpenSteri</a>
  </nav>

  <main class="main-content">
    <div class="container">
      <div class="card" role="main" aria-label="Wi-Fi Status">
        <div class="card-header">
          <h1 class="card-title">Wi-Fi Status</h1>
        </div>
        <div id="wifiStatusMsg" class="status-message hidden" aria-live="polite"></div>
        <div id="wifiInfo" class="hidden">
          <div class="status-row">
            <span class="status-label">SSID:</span>
            <span class="status-value" id="ssidValue">-</span>
          </div>
          <div class="status-row">
            <span class="status-label">IP Address:</span>
            <span class="status-value" id="ipValue">-</span>
          </div>
          <div class="status-row">
            <span class="status-label">Status:</span>
            <span class="status-value" id="connStatus">-</span>
          </div>
        </div>
        <button class="btn btn-outline" id="refreshBtn" onclick="fetchWifiStatus()">
          <span id="refreshIcon">ðŸ”„</span> Refresh
        </button>
      </div>
    </div>
  </main>
  <script>
    const wifiStatusMsg = document.getElementById('wifiStatusMsg');
    const wifiInfo = document.getElementById('wifiInfo');
    const ssidValue = document.getElementById('ssidValue');
    const ipValue = document.getElementById('ipValue');
    const connStatus = document.getElementById('connStatus');
    const refreshBtn = document.getElementById('refreshBtn');
    const refreshIcon = document.getElementById('refreshIcon');

    async function fetchWifiStatus() {
      wifiStatusMsg.textContent = 'Checking Wi-Fi status...';
      wifiStatusMsg.className = 'status-message status-info visible';
      wifiInfo.className = 'hidden';
      refreshBtn.disabled = true;
      refreshIcon.classList.add('spinner');
      try {
        const res = await fetch('/api/wifi');
        if (!res.ok) throw new Error('Network error');
        const data = await res.json();
        if (data && data.connected) {
          ssidValue.textContent = data.ssid || '-';
          ipValue.textContent = data.ip || '-';
          connStatus.textContent = 'Connected';
          connStatus.className = 'status-value status-online';
          wifiStatusMsg.textContent = 'Connected to Wi-Fi.';
          wifiStatusMsg.className = 'status-message status-success visible';
        } else {
          ssidValue.textContent = '-';
          ipValue.textContent = '-';
          connStatus.textContent = 'Not Connected';
          connStatus.className = 'status-value status-offline';
          wifiStatusMsg.textContent = 'Not connected to any Wi-Fi.';
          wifiStatusMsg.className = 'status-message status-info visible';
        }
        wifiInfo.className = 'visible';
      } catch (err) {
        wifiStatusMsg.textContent = 'Failed to get Wi-Fi status. Please try again.';
        wifiStatusMsg.className = 'status-message status-error visible';
        wifiInfo.className = 'hidden';
      } finally {
        refreshBtn.disabled = false;
        refreshIcon.classList.remove('spinner');
      }
    }
    window.onload = fetchWifiStatus;
  </script>
</body>
</html> 